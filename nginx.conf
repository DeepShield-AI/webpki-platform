
# 你说的「dev server 上可以访问」，但在生产环境 Nginx + Flask 下访问同样路由 404，这其实是前后端环境差异导致的很常见问题。下面帮你梳理原因和区别：
# 1. 为什么开发环境(dev server)能访问？
# Vue 开发环境使用 vue-cli-service serve 启动的 dev server。
# 这个 dev server 内置了前端路由支持（history mode），所有前端路由都会被自动 fallback 到 index.html。
# 也就是说，访问 /system/host_view/103.226.139.101，它直接返回前端的 SPA 页面，由 Vue Router 解析路由，渲染对应页面。
# 开发环境没有后端服务参与前端路由处理。
# 2. 为什么生产环境 Nginx + Flask 访问时报 404？
# Nginx 直接接收请求，默认它会根据路径查找对应的文件或转发请求。
# 你的 /system/host_view/103.226.139.101 路径，没有匹配任何静态资源文件，
# 也没有配置 Nginx 将请求 fallback 到前端的 index.html，
# 所以 Nginx 把请求转发给 Flask，Flask 没有对应的路由，所以报 404。
# 或者 Nginx 直接报 404。
# 3. 如何让生产环境和开发环境行为一致？
# 在 Nginx 中配置 SPA 路由 fallback：
# location / {
#     root /var/www/pki-internet-platform/dist/;
#     try_files $uri $uri/ /index.html;
# }
# 这样对任何非静态文件请求都会返回 index.html，
# 由前端 Vue Router 负责渲染对应页面。

server {
	listen 80 default_server;
	server_name 121.40.177.246;
    
	location /api/ {
        include uwsgi_params;
        uwsgi_pass 127.0.0.1:5000;
    }

	location / {
		root /var/www/pki-internet-platform/dist/;
		try_files $uri $uri/ /index.html;
	}
}
